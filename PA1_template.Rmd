---
title: "Reproducible Research: Peer Assessment 1"
author: rcblt@github.com
output: 
html_document:
keep_md: true
---

## Load required packages
```{r}
library(dplyr, lubridate)

```



## Loading and preprocessing the data
```{r}
activity <- read.csv("activity.csv", 
                     colClasses=c("integer", "Date", "integer"), 
                     header= TRUE, 
                     as.is= TRUE)

```


## What is mean total number of steps taken per day?
```{r}
totalStepsByDay <- activity %>% 
  filter(!is.na(steps)) %>% 
  group_by(date) %>% 
  summarise(total = sum(steps))
hist(totalStepsByDay$total, 
     breaks= 20, 
     main= "Histogram of total steps per day", 
     xlab= "Total steps",
     xaxp= c(0, 22000, 22))
legend("topright", 
       legend= c(paste("Median", median(totalStepsByDay$total)), 
                 paste("Mean", round(mean(totalStepsByDay$total), 2))), 
       lty= c("solid", "dotted"), 
       col= c("red", "blue"), 
       lwd= 2)
abline(v= median(totalStepsByDay$total), col= "red", lwd= 2)
abline(v= mean(totalStepsByDay$total), col= "blue", lty= "dotted", lwd= 2)
```



## What is the average daily activity pattern?
```{r}
dailyAveregeSteps <- activity %>% 
  filter(!is.na(steps)) %>% 
  group_by(interval) %>% 
  summarise(average= mean(steps))
maxInterval <- dailyAveregeSteps[which.max(dailyAveregeSteps$average),]$interval
with(dailyAveregeSteps, 
     plot(interval, average, 
          type= "l",
          xaxp= c(0, 2400, 24),
          main= "Daily average steps on 5' intervals",
          xlab= "Interval",
          ylab= "Steps"))
abline(v= maxInterval, lwd= 2, col= "red", lty= "dotted")
legend("topright", 
       legend= paste("Max average @", 
                     maxInterval, 
                     "=", 
                     round(dailyAveregeSteps[dailyAveregeSteps$interval== maxInterval,]$average, 2)), 
       lty= "dotted", 
       col= "red", 
       lwd= 2)
```



## Imputing missing values
```{r}
naRows <- activity %>% filter(is.na(steps)) %>% count()

```



## Are there differences in activity patterns between weekdays and weekends?
